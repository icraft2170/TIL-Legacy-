---
title: JSP_04
---

## JSP 처리과정

WAS(Web Application Server)가 클라이언트로 부터 요청을 받았을 때

- JSP에 해당하는 서블릿이 존재하지 않을 겨우
    1. JSP 페이지로 부터 자바코드를 생성한다.
    1. 자바 코드를 컴파일하여 서블릿 클래스를 생성한다.
    1. 서블릿에 클라이언트 요청을 전달.
    1. 서블릿이 요청을 처리한 결과를 응답으로 생성하여 웹브라우저에 전달한다
- 서블릿이 존재하는 경우
    1. 서블릿에 클라이언트를 요청한다.
    1. 서블릿이 요청을 처리한 결과를 응답으로 생성
    1. 응답을 웹브라우저에 전달

> 웹브라우저의 요청을 WAS가 받아 서블릿 클래스에서 응답을 생성한 후 웹브라우저에 응답한다.

## 출력버퍼와 응답

- JSP 페이지는 응답 결과를 곧바로 웹 브라우저에 전송하지 않고, 출력 버퍼에 저장했다가 한번에 웹브라우저에 전달한다.
> 클라이언트 요청 -> WAS가 JSP페이지 실행 -> 출력버퍼에 저장 -> 버퍼에 저장된 내용을 클라이언트에 전송

- 버퍼에 저장하여 한꺼번에 웹 브라우저에 전송했을 때 장점
    - 데이터 전송 성늠 향상
    - `JSP 실행 도중`에 버퍼를 비우고 `새로운 내용 전송 가능`
    - 버퍼가 다 차기 전까지 `헤더 변경 가능`

### 페이지 디렉티브 버퍼 설정

`<%@ page buffer ="4kb">`
- 디렉티브를 통해 버퍼의 크기를 지정할 수 있는데 KB(킬로바이트) 단위로 지정해야한다.
- 버퍼 크기를 지정하지 않을 시 자동으로 8KB이상의 크기를 갖는 버퍼를 사용하도록 한다.

`<%@ page buffer ="none" %>`
- 버퍼를 사용하고 싶지 않다면 `none`으로 지정해 줄 수 있다. (이런 상황은 거의 없음)
    - 곧바로 전송되기 때문에 출력 내용 취소가 불가능하다.
    - `<jsp:forward>` 기능을 사용할 수 없다

- 버퍼의 동작 방식
    1. 버퍼에 저장
    1. 버퍼에 데이터가 가득 참
    1. 버퍼에 쌓인 데이터를 전송하고 버퍼를 비움
    1. 계속해서 버퍼에 데이터를 적재
> 3번 과정에서 버퍼에 보관한 데이터를 웹 브라우저에 전송하는데 전송 전 응답 상태 코드와 응답 헤더를 먼저 전송한다.

```
플러시(flush)
버파가 다 찼을 때, 버퍼에 쌓인 데이터를 전송해야 할곳에 전송하고 버퍼를 비우는 것
```

`<%@ page buffer ="4kb" autoFlush="true/false">`
- true : 버퍼가 다 차면 버퍼를 플러시하고 계속 작업 진행
- false : 버퍼가 다 차면 익셉션을 발생시키고 작업 중단

### 웹 어플리케이션 폴더 구성과 URL 매핑

#### 웹 어플리케이션 폴더 구조

- `기본 구조`
    - webapp
        - WEB-INF
            - classes
            - lib

- WEB-INF : 웹 어플리케이션 설정 정보를 담고 있는 web.xml 파일이 위치
- WEB-INF\classes : 웹 어플리케이션에서 사용하는 클래스 파일이 위치
- WEB-INF\lib : 웹 어플리케이션에서 사용하는 jar파일이 위치

#### 웹 어플리케이션 폴더와 URL 관계
- webapp 을 root로 하여 하위폴더는 서버주소 뒷쪽에 컨텍스트 경로(cotext path)가 이루어짐
- request 기본 객체에 컨텍스트 경로를 제공하는 메서드 `request.getContextPath()`가 있다.

### 웹 애플리케이션 배포

#### 웹 어플리케이션을 WAS에서 배포하는 방법은 2가지가 있다.
- 대상 폴더에 파일을 직접 복사
- war 파일로 묶어서 배포

#### 톰캣 WAR(Web Application Archive) 배포
`WAR(Web Application Archive)`
- 웹 어플리케이션 구성요소를 하나로 묶어 놓은 파일
- `jar cvf chap04.war` : cmd에서 char04폴더에 위치한후 chap04.war파일을 생성하는 방법
    - `cvf옵션` c: 새파일 생성,v:세부 정보 콘솔 표시,f:생성할 파일 이름 지정
- war파일을 톰캣에 웹 어플리케이션 폴더에 복사해주면 배포가 된다


