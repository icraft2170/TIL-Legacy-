---
title: DB
---

# SQL

## SQL의 종류
- DDL(Data Definition Language) : 데이터 구조를 정의하는데 사용하는 명령어
- DML(Data Manipulation Language) : 데이터 수정,삭제,추가,검색 명령어
- DCL(Data Control Language) : 권한을 주고 회수하는 명령어
- TCL(Transaction Control Language) : 논리적 작업단위를 묶어 DML에 의해 조작된 결과를 트랜잭션 별로 제어하는 명령어

## 일반 집합 연산자
1. UNION
    - 합집합 기능을 제공하며, 공통 교집합 중복을 제거하기 위해 시스템에 부하를 주는 정렬작업이 진행됨
    - UNION ALL 기능도 제공하며 공통 집합도 중복하여 보여주기 때문에 시스템에 부하를 주는 정렬작업이 진행되지 않음 따라서 UNION ALL의 사용을 권고 
2. INTERSECTION
    - 수학의 교집합으로 두 집합의 공통 집합을 추출한다
3. DIFFERENCE
    - 수학의 차집합으로서 첫 번째 집합에서 두 번째 집합의 공통부분을 제거한 부분
4. PRODUCT
    - 곱집합으로 M*N (행렬의 곱), JOIN 조건이 없는 경우 생길 수 있는 모든 데이터 조합.


## 순수 관계 연산자

5. SELECT
    - WHERE절의 조건절 기능으로 구현
6. PROJECT
    - SELECT 절의 컬럼 선택기능
7. JOIN
    - NATURAL JOIN, INNER JOIN, OUTER JOIN, USING조건절, ON조건절 등으로 다양하게 발전 
    - 정규화를 끝내 흩어진 데이터를 연결하여 출력할 때 사용.
8. DIVIDE
    - 나눗셈과 비슷한 개념으로 테이블로 테이블을 나누는 값을 나오게함 중복값 저장 때문에 현재 사용하지않음




## 테이블
- 데이터를 저장하는 객체(Object)로 관계형 DB의 기본 단위
- 모든 자료는 테이블에 등록되고, 우리는 테이블로부터 원하는 자료를 꺼내 올 수 있다.
- 어느 특정 주제와 목적으로 만들어지는 일종의 집합
- COlUMN(열,속성),ROW(행,데이터)로 이루어져 있고 행과 열이 겹쳐지는 공간을 FIELD(필드) 라고 한다.

 ### 정규화
 - 데이터의 불필요한 중복을 줄이는 것을 `정규화`라고 한다.
 - 정합성 확보와 데이터 입력,수정,삭제시 발생하는 이상현상을 방지하기 위해 사용.

 ### 기본키(PRIMARY KEY)
- 테이블에 존재하는 각 행을 한 가지 의미로 특정할 수 있는 한 개 이상의 칼럼
 ### 외래키(FOREIGN KEY)
 - 다른 테이블의 키본키로 사용되고 있는 관계를 연결하는 칼럼 관계를 위해 공유한는 칼럼

 ### ERD(Entity Relationship Diagram)
 - Entity(개체, 테이블)간 서로의 `상관관계를 그림으로 도식화`한 것
 - `Entity, Relationship, Attribute` 3가지로 구성됨
 - IE(Information Engineering), Barker(Case*Method)등의 표기법이 존재한다.


 ## 데이터유형
- 특정 자료를 입력할 때, 그 자료를 받아들일 공간을 자료의 유형별로 나누는 기준. 특정 컬럼에 들어갈 수 있는 데이터의 유형을 규정
- 지정한 크기(Size)를 지정하여 컬럼의 하나의 필드에 들어갈 수 있는 데이터의 크기를 규정.

- CHARACTER(s)
    - 고정 길이 문자열 정보
    - s는 기본 길이 1byte(최대 길이 Oracle 2000byte SQL Server 8000byte)
    - s만큼 최대 길이, 고정 길이를 갖고 있으므로 할당된 변수 길이가 s보다 작을 경우 그 차이 길이만큼 공간으로 채워진다.
    - 크기가 고정된 데이터에 적절
    - 뒤쪽에 있는 공백은 달라도 같다고 판단함
- VARCHAR(s)
    - 가변 길이 문자열 정보
    - s는 기본 길이 1byte(최대 길이 Oracle 4000byte SQL Server 8000byte)
    - s만큼 최대 길이를 갖지만 가변 길이로 조정이 되기 때문에 할당된 변수값의 바이트만 적용됨.  
    (길이를 초과되지 않은 데이터가 입력되면 자동으로 줄어든다 다만, 그 과정에서 길이가 줄어든다.)
    - 크기가 가변적인 데이터에 적절
    - 공백의 길이도 판단하여 비교
- NUMERIC
    - 정수,실수 등 숫자 정보(Oracle은 NUMBER로, SQL Server는 10가지 이상의 숫자 타입을 갖고 있음)
    - Oracle은 처음에 전체 자리 수를 지정하고, 그 다음 소수 부분의 자리 수를 지정함.
- DATETIME
    -  날짜와 시각 정보 (Oracle은 1s 단위 SQL Server는 3.33ms 단위)

# SELECT

- 객체 내의 데이터를 조회하는 SQL문

```sql
SELECT [ALL/DISTINCT] 출력 대상 컬럼명...
FROM 테이블 명;
```
### DISTINCT/ALL
- ALL (OPTION)
    - 중복 포함 출력
- DISTINCT (OPTION)
    - 중복 제거 출력

### 애스터리스크(*)

```sql
SELECT *
FROM PLYER;
-- 플레이어 테이블의 모든 컬럼 출력
```
### ALIAS 부여하기
- 컬럼의 별칭을 부여하여 출력되는 컬럼 명을 변경 할 수 있다.
```sql
SELECT PLYER_NAME AS "선수명"
FROM PLAYER;
```
- 칼럼명 바로 뒤에 온다.
- AS, as 키워드 사용할 수 있다.
- `더블 쿼테이션("")은 공백,특수문자를 포함하거나 대소문자를 구분할때 사용`

### 산술 연산자와 합성 연산자

#### 산술 연산자
- NUMBER와 DATE 자료형에 대해 적용됨.
- 일반적인 사칙 연산을 적용가능 우선순위 괄호 사용 가능


#### 합성 연산자
- 문자와 문자를 연결하는 연산자
    - 문자와 문자를 연결하는 경우 `||(ORACLE)`
    - 문자와 문자를 연결하는 경우 `+(SQL Server)`
    - `CONCAT(string1,string2)`함수를 사용 할 수 있다(ORACLE,SQL Server)
    - 칼럼과 문자 또는 다른 컬럼도 연결가능
    - 문자 표현식의 결과에 의해 새로운 컬럼을 생성한다.


## 함수(Function)
- 내장함수(Built-in Function)
    - 단일 행 함수(Single-Row Function)
    - 다중 행 함수(Multi-Row Function)
        - 집계 함수(Aggregate Function)
        - 그룹 함수(Group Function)
        - 윈도우 함수(Window Function)
- 사용자 정의 함수(User Defined Function)

```sql
 Function_Name(Parameter...);
```

### 단일행 함수
|종류|내용|
|---------|-----------------------------------|
|문자형함수|문자 입력시 문자나 숫자 반환||
|숫자형 함수|숫자입력시 숫자 반환||
|날짜형 함수|날짜형 함수 DATE를 연산||
|변환형 함수|문자,숫자,날짜형 간의 형변환||
|NULL 관련 함수|NULL 처리함수|

- `SELECT, WHERE,ORDER BY` 절에서 사용가능
- M(인자):1(리턴값) 인자가 많아도 단 하나의 리턴값이 나온다.
- 함수의 인자로 상수,변수,표현식을 사용 가능.
- 함수는 중첩 가능


### 문자형 함수
| 함수 | 설명 |
|-------|--------------------------|
|LOWER(문자열)|파라미터의 알파벳 문자를 소문자로 바꾸어 준다|
|UPPER(문자열)|문자열의 알파벳 문자를 대문자로 바꾸어줌|
|ASCII(문자)|문자나 숫자를 아스키 코드로 변환|
|CHR/CHAR(ASCII번호)|아스키 코드를 문자로 변환|
|CONCAT(문자열1, 문자열2)|문자열1 과 문자열2를 붙임|
|SUBSTR/SUBSTRING(문자열,m[,n])|문자열 중 m위치에서 n개의 문자 길이에 해당하는 문자를 돌려준다. n이 생략되면 마지막 까지이다.|
|LENGTH/LEN(문자열)|문자열의 개수를 숫자값으로 돌려줌|
|LTRIM(문자열[,지정문자])/LTRIM(문자열)|문자열의 첫 문자부터 확인해서 지정 문자가 나타나면 해당 문자를 제거함(디폴트 값은 공백)|
|RTRIM(문자열[,지정문자])/RTRIM(문자열)|문자열의 끝 문자부터 확인해서 지정 문자가 나타나면 해당 문자를 제거함(디폴트 값은 공백)|
|TRIM(문자열[,지정문자])/TRIM(지정 문자 `FROM` 문자열)|문자열 양쪽에서 지정문자 삭제( 기본값은 공백)|

### 숫자형 함수
- 숫자 데이터를 입력받아 처리하고 숫자를 리턴하는 함수

| 함수 | 설명 |
|-------|--------------------------|
|ABS(숫자)|숫자의 절대값을 반환한다|
|SIGN(숫자)|숫자가 양수인지,음수인지,0인지 구별|
|MOD(숫자1,숫자2)|숫자1을 수자2로 나누어 나머지를 리턴한다.|
|CEIL/CEILING(숫자)|숫자보다 크거나 같은 최소 정수를 리턴한다|
|FLOOR(숫자)|숫자보다 작거나 같은 최대 정수를 리턴한다.|
|ROUND(숫자[,m])|숫자를 소수점 m자리에서 반올림해 리턴한다. 디폴트 값은 0이다.|
|TRUNC(숫자[,m])|숫자를 소수 m자리에서 잘라서 버린다. 디폴트 값은 0|
|SIN,COS,TAN,...|숫자의 삼각함수 값을 리턴|
|EXP(숫자)|숫자의 지수 값을 리턴|
|POWER(수1,수2)|숫자의 거듭제곱 값을 리턴 수1의 수2 제곱값|
|SORT(숫자)|숫자의 제곱근 값을 리턴|
|LOG(숫자1,숫자2)|숫자1을 밑수로 하는 숫자2의 로그값|
|LN(숫자)|숫자의 자연 로그 값(밑이 10)|
### 날짜형 함수
- DATE값을 연산하는 함수

#### 날짜형 데이터 연산
|연산|결과|설명|
|------|-----|----------------------|
|날짜 + 숫자| 날짜 | 숫자만큼의 날수를 날짜에 더한다.|
|날짜 - 숫자| 날짜 | 숫자만큼의 날수를 날짜에서 뺀다.
|날짜1 - 날짜2| 숫자 | 날짜1과 날짜2의 차이를 일수로 반환|
|날짜 +숫자/24| 날짜 | 시간을 날짜에 더한다.|

```sql
SELECT ENAME AS 사원명, HIREDATE AS 입사일자
, EXTRACT (YEAR FROM HIREDATE) AS 입사년도
, EXTRACT (MONTH FROM HIREDATE) AS 입사월
, EXTRACT (DAY FROM HIREDATE) AS 입사일
FROM EMP;

-- EXTRACT(YEAR/MONTH/DAY/... FROM DATE형)  
-- DATE형의 년/월/일 데이터를 출력 
```

### 변환형 함수
- 특정 데이터 타입을 다양한 형식으로 출력하고 싶을 경우에 사용된다. 변환형 함수는 크게 두 가지 방식이 존재한다.

|종류|설명|
|-----|------------------------------------------------------------------|
|명시적(Explicit) 데이터 형변환|데이터 변환형 함수를 사용해 데이터 유형을 변환하도록 명시 해주는 경우|
|암시적(Implicit) 데이터 형변환| 데이터베이스가 자동으로 데이터 유형을 변환해 계산하는 경우|
- 암시적 형변환의 경우 성능 저하가 발생할 수 있고, 에러 발생 가능성이 존재하여 명시적 데이터 형변환을 써주는 것이 바람직하다.

|변환형 함수| 함수 설명 |
|----------|-----------|
|TO_NUMBER(문자열)|숫자로 변환 가능한 문자열을 숫자로 변환한다|
|TO_CHAR(수/날짜[,FORMAT])|숫자나 날짜로 주어진 FORMAT 형태인 문자열 타입으로 변환한다.|
|TO_DATE(문자열[,FORMAT])|문자열을 주어진 FORMAT형태인 날짜 타입으로 변환한다.|
- 위 함수는 ORACLE 기준


### CASE 표현

- SQL에서 조건문(IF-ELSE)와 같은 역할을 한다

```sql
CASE 
    WHEN (조건문) THEN (값)
    ELSE (조건 해당하지 않은 나머지 값)
END
```
```sql
CASE 비교대상 
    WHEN (비교값) THEN (값)
    WHEN (비교값) THEN (값)
    ELSE (조건 해당하지 않은 나머지 값)
END
```


### NULL 관련 함수

#### NVL/ISNULL

- NULL 값은 정의되지 않은 값으로 0 또는 공백과 다르다.
- NULL 값과 연산한 경우 결과 값도 NULL 값이다.

|함수|함수설명|
|-------------:|-------------------|
|NVL(표현식1, 표현식2)| 표현식1의 결과값이 NULL이면 표현식 2의 값을 출력한다 단,표현식1과 표현식2의 결과 데이터 타입이 같아야 함.|
|NULLIF(표현식1, 표현식2)|표현식1이 표현식2와 같으면 NULL을 같지않으면 표현식1을 리턴|
|COALESCE(표현식1, 표현식2,...)|임의의 개수 표현식에서 NULL이 아닌 최초의 표현식을 나타낸다 모든 표현식이 NULL이라면 NULL을 리턴|


















